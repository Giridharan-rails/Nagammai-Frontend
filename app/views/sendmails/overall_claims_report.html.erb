<section class="users_admin">
    <div class="container-fluid">
        <header>
            <ol class="breadcrumb">
            </ol>
        </header>
        <div class="date-search">
            <%=form_for "filter",:url=>{:controller=>"sendmails",:action=>"overall_claims_report"} do |i|%>
            <div class="row">
                <div class="col-md-3">
                    <label>Supplier</label>
                    <br>
                    <%= select_tag "supplier_id", options_for_select(@supplier.map { |obj| [obj['supplier_name'], obj['id']] }, @supplier_id), id: "supplier", autofocus: true, prompt: "select" %>
                </div>
                <div class="col-md-3">
                    <label>From Date</label>
                    <br>
                    <input name="from_date" type="text" id="dt1" class="form-control datepicker" value="<%=@from_date%>" placeholder="dd-mm-yy">
                </div>
                <div class="col-md-3">
                    <label>To Date</label>
                    <br>
                    <input name="to_date" type="text" id="dt2" class="form-control datepicker" value="<%=@to_date%>" placeholder="dd-mm-yy">
                </div>
                <div class="col-md-3">
                    <label></label>
                    <br>
                    <button class=" btn btn-primary">Show</button>
                </div>
            </div>
            <%end%>
        </div>
        <h3 class="page-title">Overall Claims</h3>
        <div class="claims_radio">
            <div class="tab-content">
                <div class="tab-pane active" id="subject1" role="tabpanel">
                    <div class="display">
                        <table class="table table-striped table_front table-list-search filter" id="example">
                            <thead class="tbl-header">
                                <tr>
                                    <th class="th_send-ordno">Claim Number</th>
                                    <th class="text-center">Claim Date</th>
                                    <th class="text-left">Supplier</th>
                                    <th class="text-right">Total Qty</th>
                                    <th class="text-right">Claim Amount</th>
                                    <th class="text-right">Settled Amount</th>
                                    <th class="">Claim Type</th>
                                    <th class="text-right">Bal=(Claim - WS)</th>
                                    <th class="th_send-preview">Preview</th>
                                </tr>
                            </thead>
                            <tbody class="scroll">
                              <%if @pending_claims["expiry"].present?%>
                                <%@pending_claims["expiry"].map do |j|%>
                                    <%claim_amount=[]%>
                                    <% j["claim_amount"].map {|k|  claim_amount << k.to_f} %>
                                    <%ws_settle_amount=[]%>
                                    <%j["ws_settle_amount"].map {|k| ws_settle_amount << k.to_f}%>
                                  <%if ws_settle_amount.sum.round(2) <= 0%>
                                    <%c=0%>
                                    <tr>
                                      <td style="color: red;">
                                          <%=j["claim_no"]%>
                                      </td>
                                      <% claim_date = j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present? %>
                                      <td class="text-center" style="color: red;" data-order="<%=j["data"][c]["ack_date"].to_date.strftime("%Y-%m-%d") if j["data"][c]["ack_date"].present?%>">
                                          <%=j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present?%>
                                      </td>
                                      <td class="text-center" style="color: red"><%=j["data"][c]["supplier"]["supplier_name"]%></td>
                                      <%quantity=[]%>
                                      <%j["total_quantity"].map {|k|  quantity << k.to_i}%>
                                      <td class="text-right" style="color: red;">
                                          <%=quantity.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: red;">
                                          <%= '%.2f' % claim_amount.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: red;">
                                          <%= '%.2f' % ws_settle_amount.sum.round(2)%>
                                      </td>
                                      <td style="color: red;">ExpiryDamage</td>
                                      <td class="text-right" style="color: red;">
                                          <%= '%.2f' % (claim_amount.sum.round(2) - ws_settle_amount.sum.round(2) )%>
                                      </td>
                                      <td style="text-align: center;" style="color: red;">
                                          <%=link_to "Preview",claims_expiry_damage_claim_path(claim_no:j["claim_no"], claim_date: claim_date, :id=>"pendingreport") ,class: "btn btn-link btn_pad"%>
                                      </td>
                                    </tr>
                                    <%c=c+1%>
                                  <%elsif ws_settle_amount.sum.round(2) >= claim_amount.sum.round(2)%>
                                    <%c=0%>
                                    <tr>
                                      <td style="color: green;">
                                          <%=j["claim_no"]%>
                                      </td>
                                      <% claim_date = j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present? %>
                                      <td class="text-center" style="color: green;" data-order="<%=j["data"][c]["ack_date"].to_date.strftime("%Y-%m-%d") if j["data"][c]["ack_date"].present?%>">
                                          <%=j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present?%>
                                      </td>
                                      <td class="text-center" style="color: green"><%=j["data"][c]["supplier"]["supplier_name"]%></td>
                                      <%quantity=[]%>
                                      <%j["total_quantity"].map {|k|  quantity << k.to_i}%>
                                      <td class="text-right" style="color: green;">
                                          <%=quantity.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: green;">
                                          <%= '%.2f' % claim_amount.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: green;">
                                          <%= '%.2f' % ws_settle_amount.sum.round(2)%>
                                      </td>
                                      <td style="color: green;">ExpiryDamage</td>
                                      <td class="text-right" style="color: green;">
                                          <%=' %.2f' % (claim_amount.sum.round(2) - ws_settle_amount.sum.round(2) )%>
                                      </td>
                                      <td style="text-align: center;" style="color: green;">
                                          <%=link_to "Preview",claims_expiry_damage_claim_path(claim_no:j["claim_no"], claim_date: claim_date, :id=>"pendingreport") ,class: "btn btn-link btn_pad"%>
                                      </td>
                                    </tr>
                                    <%c=c+1%>
                                  <%else%>
                                    <%c=0%>
                                    <tr>
                                      <td style="color: blue;">
                                          <%=j["claim_no"]%>
                                      </td>
                                      <% claim_date = j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present? %>
                                      <td class="text-center" style="color: blue;" data-order="<%=j["data"][c]["ack_date"].to_date.strftime("%Y-%m-%d") if j["data"][c]["ack_date"].present?%>">
                                          <%=j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present?%>
                                      </td>
                                      <td class="text-center" style="color: blue"><%=j["data"][c]["supplier"]["supplier_name"]%></td>
                                      <%quantity=[]%>
                                      <%j["total_quantity"].map {|k|  quantity << k.to_i}%>
                                      <td class="text-right" style="color: blue;">
                                          <%=quantity.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: blue;">
                                          <%= '%.2f' % claim_amount.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: blue;">
                                          <%= '%.2f' % ws_settle_amount.sum.round(2)%>
                                      </td>
                                      <td style="color: blue;">ExpiryDamage</td>
                                      <td class="text-right" style="color: blue;">
                                          <%=' %.2f' % (claim_amount.sum.round(2) - ws_settle_amount.sum.round(2) )%>
                                      </td>
                                      <td style="text-align: center;" style="color: blue;">
                                          <%=link_to "Preview",claims_expiry_damage_claim_path(claim_no:j["claim_no"], claim_date: claim_date, :id=>"pendingreport") ,class: "btn btn-link btn_pad"%>
                                      </td>
                                    </tr>
                                    <%c=c+1%>
                                  <%end%>
                                  <%c=c+1%>
                                <%end%>
                              <%end%>
                              <%if @pending_claims["ratechange"].present?%>
                                <%@pending_claims["ratechange"].map do |j|%>
                                    <%claim_amount=[]%>
                                    <% j["claim_amount"].map {|k|  claim_amount << k.to_f} %>
                                    <%ws_settle_amount=[]%>
                                    <%j["ws_settle_amount"].map {|k| ws_settle_amount << k.to_f}%>
                                  <%if ws_settle_amount.sum.round(2) <= 0%>
                                    <%c=0%>
                                    <tr>
                                      <td style="color: red;">
                                          <%=j["claim_no"]%>
                                      </td>
                                      <% claim_date = j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present? %>
                                      <td class="text-center" style="color: red;" data-order="<%=j["data"][c]["ack_date"].to_date.strftime("%Y-%m-%d") if j["data"][c]["ack_date"].present?%>">
                                          <%=j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present?%>
                                      </td>
                                      <td class="text-center" style="color: red"><%=j["data"][c]["supplier"]["supplier_name"]%></td>
                                      <%quantity=[]%>
                                      <%j["total_quantity"].map {|k|  quantity << k.to_i}%>
                                      <td class="text-right" style="color: red;">
                                          <%=quantity.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: red;">
                                          <%= '%.2f' % claim_amount.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: red;">
                                          <%= '%.2f' % ws_settle_amount.sum.round(2)%>
                                      </td>
                                      <td style="color: red;">RateChange</td>
                                      <td class="text-right" style="color: red;">
                                          <%= '%.2f' % (claim_amount.sum.round(2) - ws_settle_amount.sum.round(2) )%>
                                      </td>
                                      <td style="text-align: center;" style="color: red;">
                                          <%=link_to "Preview",claims_rate_change_claim_path(claim_no:j["claim_no"], claim_date: claim_date, :id=>"pendingreport") ,class: "btn btn-link btn_pad"%>
                                      </td>
                                    </tr>
                                    <%c=c+1%>
                                  <%elsif ws_settle_amount.sum.round(2) >= claim_amount.sum.round(2)%>
                                    <%c=0%>
                                    <tr>
                                      <td style="color: green;">
                                          <%=j["claim_no"]%>
                                      </td>
                                      <% claim_date = j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present? %>
                                      <td class="text-center" style="color: green;" data-order="<%=j["data"][c]["ack_date"].to_date.strftime("%Y-%m-%d") if j["data"][c]["ack_date"].present?%>">
                                          <%=j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present?%>
                                      </td>
                                      <td class="text-center" style="color: green"><%=j["data"][c]["supplier"]["supplier_name"]%></td>
                                      <%quantity=[]%>
                                      <%j["total_quantity"].map {|k|  quantity << k.to_i}%>
                                      <td class="text-right" style="color: green;">
                                          <%=quantity.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: green;">
                                          <%= '%.2f' % claim_amount.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: green;">
                                          <%= '%.2f' % ws_settle_amount.sum.round(2)%>
                                      </td>
                                      <td style="color: green;">RateChange</td>
                                      <td class="text-right" style="color: green;">
                                          <%=' %.2f' % (claim_amount.sum.round(2) - ws_settle_amount.sum.round(2) )%>
                                      </td>
                                      <td style="text-align: center;" style="color: green;">
                                          <%=link_to "Preview",claims_rate_change_claim_path(claim_no:j["claim_no"], claim_date: claim_date, :id=>"pendingreport") ,class: "btn btn-link btn_pad"%>
                                      </td>
                                    </tr>
                                    <%c=c+1%>
                                  <%else%>
                                    <%c=0%>
                                    <tr>
                                      <td style="color: blue;">
                                          <%=j["claim_no"]%>
                                      </td>
                                      <% claim_date = j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present? %>
                                      <td class="text-center" style="color: blue;" data-order="<%=j["data"][c]["ack_date"].to_date.strftime("%Y-%m-%d") if j["data"][c]["ack_date"].present?%>">
                                          <%=j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present?%>
                                      </td>
                                      <td class="text-center" style="color: blue"><%=j["data"][c]["supplier"]["supplier_name"]%></td>
                                      <%quantity=[]%>
                                      <%j["total_quantity"].map {|k|  quantity << k.to_i}%>
                                      <td class="text-right" style="color: blue;">
                                          <%=quantity.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: blue;">
                                          <%= '%.2f' % claim_amount.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: blue;">
                                          <%= '%.2f' % ws_settle_amount.sum.round(2)%>
                                      </td>
                                      <td style="color: blue;">RateChange</td>
                                      <td class="text-right" style="color: blue;">
                                          <%=' %.2f' % (claim_amount.sum.round(2) - ws_settle_amount.sum.round(2) )%>
                                      </td>
                                      <td style="text-align: center;" style="color: blue;">
                                          <%=link_to "Preview",claims_rate_change_claim_path(claim_no:j["claim_no"], claim_date: claim_date, :id=>"pendingreport") ,class: "btn btn-link btn_pad"%>
                                      </td>
                                    </tr>
                                    <%c=c+1%>
                                  <%end%>
                                  <%c=c+1%>
                                <%end%>
                              <%end%>
                              <%if @pending_claims["non_findable"].present?%>
                                <%@pending_claims["non_findable"].map do |j|%>
                                    <%claim_amount=[]%>
                                    <% j["claim_amount"].map {|k|  claim_amount << k.to_f} %>
                                    <%ws_settle_amount=[]%>
                                    <%j["ws_settle_amount"].map {|k| ws_settle_amount << k.to_f}%>
                                  <%if ws_settle_amount.sum.round(2) <= 0%>
                                    <%c=0%>
                                    <tr>
                                      <td style="color: red;">
                                          <%=j["claim_no"]%>
                                      </td>
                                      <% claim_date = j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present? %>
                                      <td class="text-center" style="color: red;" data-order="<%=j["data"][c]["ack_date"].to_date.strftime("%Y-%m-%d") if j["data"][c]["ack_date"].present?%>">
                                          <%=j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present?%>
                                      </td>
                                      <td class="text-center" style="color: red"><%=j["data"][c]["supplier"]["supplier_name"]%></td>
                                      <%quantity=[]%>
                                      <%j["total_quantity"].map {|k|  quantity << k.to_i}%>
                                      <td class="text-right" style="color: red;">
                                          <%=quantity.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: red;">
                                          <%= '%.2f' % claim_amount.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: red;">
                                          <%= '%.2f' % ws_settle_amount.sum.round(2)%>
                                      </td>
                                      <td style="color: red;">Others</td>
                                      <td class="text-right" style="color: red;">
                                          <%= '%.2f' % (claim_amount.sum.round(2) - ws_settle_amount.sum.round(2) )%>
                                      </td>
                                      <td style="text-align: center;" style="color: red;">
                                          <%=link_to "Preview",claims_expiry_damage_claim_path(claim_no:j["claim_no"], claim_date: claim_date, :id=>"pendingreport") ,class: "btn btn-link btn_pad"%>
                                      </td>
                                    </tr>
                                    <%c=c+1%>
                                  <%elsif ws_settle_amount.sum.round(2) >= claim_amount.sum.round(2)%>
                                    <%c=0%>
                                    <tr>
                                      <td style="color: green;">
                                          <%=j["claim_no"]%>
                                      </td>
                                      <% claim_date = j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present? %>
                                      <td class="text-center" style="color: green;" data-order="<%=j["data"][c]["ack_date"].to_date.strftime("%Y-%m-%d") if j["data"][c]["ack_date"].present?%>">
                                          <%=j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present?%>
                                      </td>
                                      <td class="text-center" style="color: green"><%=j["data"][c]["supplier"]["supplier_name"]%></td>
                                      <%quantity=[]%>
                                      <%j["total_quantity"].map {|k|  quantity << k.to_i}%>
                                      <td class="text-right" style="color: green;">
                                          <%=quantity.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: green;">
                                          <%= '%.2f' % claim_amount.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: green;">
                                          <%= '%.2f' % ws_settle_amount.sum.round(2)%>
                                      </td>
                                      <td style="color: green;">Others</td>
                                      <td class="text-right" style="color: green;">
                                          <%=' %.2f' % (claim_amount.sum.round(2) - ws_settle_amount.sum.round(2) )%>
                                      </td>
                                      <td style="text-align: center;" style="color: green;">
                                          <%=link_to "Preview",claims_expiry_damage_claim_path(claim_no:j["claim_no"], claim_date: claim_date, :id=>"pendingreport") ,class: "btn btn-link btn_pad"%>
                                      </td>
                                    </tr>
                                    <%c=c+1%>
                                  <%else%>
                                    <%c=0%>
                                    <tr>
                                      <td style="color: blue;">
                                          <%=j["claim_no"]%>
                                      </td>
                                      <% claim_date = j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present? %>
                                      <td class="text-center" style="color: blue;" data-order="<%=j["data"][c]["ack_date"].to_date.strftime("%Y-%m-%d") if j["data"][c]["ack_date"].present?%>">
                                          <%=j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present?%>
                                      </td>
                                      <td class="text-center" style="color: blue"><%=j["data"][c]["supplier"]["supplier_name"]%></td>
                                      <%quantity=[]%>
                                      <%j["total_quantity"].map {|k|  quantity << k.to_i}%>
                                      <td class="text-right" style="color: blue;">
                                          <%=quantity.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: blue;">
                                          <%= '%.2f' % claim_amount.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: blue;">
                                          <%= '%.2f' % ws_settle_amount.sum.round(2)%>
                                      </td>
                                      <td style="color: blue;">Others</td>
                                      <td class="text-right" style="color: blue;">
                                          <%=' %.2f' % (claim_amount.sum.round(2) - ws_settle_amount.sum.round(2) )%>
                                      </td>
                                      <td style="text-align: center;" style="color: blue;">
                                          <%=link_to "Preview",claims_expiry_damage_claim_path(claim_no:j["claim_no"], claim_date: claim_date, :id=>"pendingreport") ,class: "btn btn-link btn_pad"%>
                                      </td>
                                    </tr>
                                    <%c=c+1%>
                                  <%end%>
                                  <%c=c+1%>
                                <%end%>
                              <%end%>
                              <%if @pending_claims["free_discount"].present?%>
                                <%@pending_claims["free_discount"].map do |j|%>
                                    <%claim_amount=[]%>
                                    <% j["claim_amount"].map {|k|  claim_amount << k.to_f} %>
                                    <%ws_settle_amount=[]%>
                                    <%j["ws_settle_amount"].map {|k| ws_settle_amount << k.to_f}%>
                                  <%if ws_settle_amount.sum.round(2) <= 0%>
                                    <%c=0%>
                                    <tr>
                                      <td style="color: red;">
                                          <%=j["claim_no"]%>
                                      </td>
                                      <% claim_date = j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present? %>
                                      <td class="text-center" style="color: red;" data-order="<%=j["data"][c]["ack_date"].to_date.strftime("%Y-%m-%d") if j["data"][c]["ack_date"].present?%>">
                                          <%=j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present?%>
                                      </td>
                                      <td class="text-center" style="color: red"><%=j["data"][c]["supplier"]["supplier_name"]%></td>
                                      <%quantity=[]%>
                                      <%j["total_quantity"].map {|k|  quantity << k.to_i}%>
                                      <td class="text-right" style="color: red;">
                                          <%=quantity.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: red;">
                                          <%= '%.2f' % claim_amount.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: red;">
                                          <%= '%.2f' % ws_settle_amount.sum.round(2)%>
                                      </td>
                                      <td style="color: red;">Free Discount</td>
                                      <td class="text-right" style="color: red;">
                                          <%= '%.2f' % (claim_amount.sum.round(2) - ws_settle_amount.sum.round(2) )%>
                                      </td>
                                      <td style="text-align: center;" style="color: red;">
                                          <%=link_to "Preview",claims_free_discounts_claim_path(claim_no:j["claim_no"], claim_date: claim_date, :id=>"pendingreport") ,class: "btn btn-link btn_pad"%>
                                      </td>
                                    </tr>
                                    <%c=c+1%>
                                  <%elsif ws_settle_amount.sum.round(2) >= claim_amount.sum.round(2)%>
                                    <%c=0%>
                                    <tr>
                                      <td style="color: green;">
                                          <%=j["claim_no"]%>
                                      </td>
                                      <% claim_date = j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present? %>
                                      <td class="text-center" style="color: green;" data-order="<%=j["data"][c]["ack_date"].to_date.strftime("%Y-%m-%d") if j["data"][c]["ack_date"].present?%>">
                                          <%=j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present?%>
                                      </td>
                                      <td class="text-center" style="color: green"><%=j["data"][c]["supplier"]["supplier_name"]%></td>
                                      <%quantity=[]%>
                                      <%j["total_quantity"].map {|k|  quantity << k.to_i}%>
                                      <td class="text-right" style="color: green;">
                                          <%=quantity.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: green;">
                                          <%= '%.2f' % claim_amount.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: green;">
                                          <%= '%.2f' % ws_settle_amount.sum.round(2)%>
                                      </td>
                                      <td style="color: green;">Free Discount</td>
                                      <td class="text-right" style="color: green;">
                                          <%=' %.2f' % (claim_amount.sum.round(2) - ws_settle_amount.sum.round(2) )%>
                                      </td>
                                      <td style="text-align: center;" style="color: green;">
                                          <%=link_to "Preview",claims_free_discounts_claim_path(claim_no:j["claim_no"], claim_date: claim_date, :id=>"pendingreport") ,class: "btn btn-link btn_pad"%>
                                      </td>
                                    </tr>
                                    <%c=c+1%>
                                  <%else%>
                                    <%c=0%>
                                    <tr>
                                      <td style="color: blue;">
                                          <%=j["claim_no"]%>
                                      </td>
                                      <% claim_date = j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present? %>
                                      <td class="text-center" style="color: blue;" data-order="<%=j["data"][c]["ack_date"].to_date.strftime("%Y-%m-%d") if j["data"][c]["ack_date"].present?%>">
                                          <%=j["data"][c]["ack_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["ack_date"].present?%>
                                      </td>
                                      <td class="text-center" style="color: blue"><%=j["data"][c]["supplier"]["supplier_name"]%></td>
                                      <%quantity=[]%>
                                      <%j["total_quantity"].map {|k|  quantity << k.to_i}%>
                                      <td class="text-right" style="color: blue;">
                                          <%=quantity.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: blue;">
                                          <%= '%.2f' % claim_amount.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: blue;">
                                          <%= '%.2f' % ws_settle_amount.sum.round(2)%>
                                      </td>
                                      <td style="color: blue;">Free Discount</td>
                                      <td class="text-right" style="color: blue;">
                                          <%=' %.2f' % (claim_amount.sum.round(2) - ws_settle_amount.sum.round(2) )%>
                                      </td>
                                      <td style="text-align: center;" style="color: blue;">
                                          <%=link_to "Preview",claims_free_discounts_claim_path(claim_no:j["claim_no"], claim_date: claim_date, :id=>"pendingreport") ,class: "btn btn-link btn_pad"%>
                                      </td>
                                    </tr>
                                    <%c=c+1%>
                                  <%end%>
                                  <%c=c+1%>
                                <%end%>
                              <%end%>
                              <%if @pending_claims["purchase_return"].present?%>
                                <%@pending_claims["purchase_return"].map do |j|%>
                                    <%claim_amount=[]%>
                                    <% j["claim_amount"].map {|k|  claim_amount << k.to_f} %>
                                    <%ws_settle_amount=[]%>
                                    <%j["ws_settle_amount"].map {|k| ws_settle_amount << k.to_f}%>
                                  <%if ws_settle_amount.sum.round(2) <= 0%>
                                    <%c=0%>
                                    <tr>
                                      <td style="color: red;">
                                          <%=j["claim_no"]%>
                                      </td>
                                      <% claim_date = j["data"][c]["claim_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["claim_date"].present? %>
                                      <td class="text-center" style="color: red;" data-order="<%=j["data"][c]["claim_date"].to_date.strftime("%Y-%m-%d") if j["data"][c]["claim_date"].present?%>">
                                          <%=j["data"][c]["claim_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["claim_date"].present?%>
                                      </td>
                                      <td class="text-center" style="color: red"><%=j["data"][c]["supplier"]["supplier_name"]%></td>
                                      <%quantity=[]%>
                                      <%j["total_quantity"].map {|k|  quantity << k.to_i}%>
                                      <td class="text-right" style="color: red;">
                                          <%=quantity.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: red;">
                                          <%= '%.2f' % claim_amount.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: red;">
                                          <%= '%.2f' % ws_settle_amount.sum.round(2)%>
                                      </td>
                                      <td style="color: red;">Purchase Return</td>
                                      <td class="text-right" style="color: red;">
                                          <%= '%.2f' % (claim_amount.sum.round(2) - ws_settle_amount.sum.round(2) )%>
                                      </td>
                                      <td style="text-align: center;" style="color: red;">
                                          <%=link_to "Preview",claims_purchase_return_claim_path(claim_no:j["claim_no"], claim_date: claim_date, :id=>"pendingreport") ,class: "btn btn-link btn_pad"%>
                                      </td>
                                    </tr>
                                    <%c=c+1%>
                                  <%elsif ws_settle_amount.sum.round(2) >= claim_amount.sum.round(2)%>
                                    <%c=0%>
                                    <tr>
                                      <td style="color: green;">
                                          <%=j["claim_no"]%>
                                      </td>
                                      <% claim_date = j["data"][c]["claim_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["claim_date"].present? %>
                                      <td class="text-center" style="color: green;" data-order="<%=j["data"][c]["claim_date"].to_date.strftime("%Y-%m-%d") if j["data"][c]["claim_date"].present?%>">
                                          <%=j["data"][c]["claim_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["claim_date"].present?%>
                                      </td>
                                      <td class="text-center" style="color: green"><%=j["data"][c]["supplier"]["supplier_name"]%></td>
                                      <%quantity=[]%>
                                      <%j["total_quantity"].map {|k|  quantity << k.to_i}%>
                                      <td class="text-right" style="color: green;">
                                          <%=quantity.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: green;">
                                          <%= '%.2f' % claim_amount.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: green;">
                                          <%= '%.2f' % ws_settle_amount.sum.round(2)%>
                                      </td>
                                      <td style="color: green;">Purchase Return</td>
                                      <td class="text-right" style="color: green;">
                                          <%=' %.2f' % (claim_amount.sum.round(2) - ws_settle_amount.sum.round(2) )%>
                                      </td>
                                      <td style="text-align: center;" style="color: green;">
                                          <%=link_to "Preview",claims_purchase_return_claim_path(claim_no:j["claim_no"], claim_date: claim_date, :id=>"pendingreport") ,class: "btn btn-link btn_pad"%>
                                      </td>
                                    </tr>
                                    <%c=c+1%>
                                  <%else%>
                                    <%c=0%>
                                    <tr>
                                      <td style="color: blue;">
                                          <%=j["claim_no"]%>
                                      </td>
                                      <% claim_date = j["data"][c]["claim_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["claim_date"].present? %>
                                      <td class="text-center" style="color: blue;" data-order="<%=j["data"][c]["claim_date"].to_date.strftime("%Y-%m-%d") if j["data"][c]["claim_date"].present?%>">
                                          <%=j["data"][c]["claim_date"].to_date.strftime("%d-%m-%Y") if j["data"][c]["claim_date"].present?%>
                                      </td>
                                      <td class="text-center" style="color: blue"><%=j["data"][c]["supplier"]["supplier_name"]%></td>
                                      <%quantity=[]%>
                                      <%j["total_quantity"].map {|k|  quantity << k.to_i}%>
                                      <td class="text-right" style="color: blue;">
                                          <%=quantity.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: blue;">
                                          <%= '%.2f' % claim_amount.sum.round(2)%>
                                      </td>
                                      <td class="text-right" style="color: blue;">
                                          <%= '%.2f' % ws_settle_amount.sum.round(2)%>
                                      </td>
                                      <td style="color: blue;">Purchase Return</td>
                                      <td class="text-right" style="color: blue;">
                                          <%=' %.2f' % (claim_amount.sum.round(2) - ws_settle_amount.sum.round(2) )%>
                                      </td>
                                      <td style="text-align: center;" style="color: blue;">
                                          <%=link_to "Preview",claims_purchase_return_claim_path(claim_no:j["claim_no"], claim_date: claim_date, :id=>"pendingreport") ,class: "btn btn-link btn_pad"%>
                                      </td>
                                    </tr>
                                    <%c=c+1%>
                                  <%end%>
                                  <%c=c+1%>
                                <%end%>
                              <%end%>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<script type="text/javascript">
  $(document).ready(function() {
      $('#example').DataTable({
          dom: 'Bfrtip',
          bSort: true,
          buttons: [{
                  extend: 'excelHtml5',
                  exportOptions: {
                      columns: [0, 1, 2, 3, 4, 5, 6]
                  }
              },
              {
                  extend: 'pdfHtml5',
                  exportOptions: {
                      columns: [0, 1, 2, 3, 4, 5, 6]
                  }
              },
              {
                  extend: 'print',
                  exportOptions: {
                      columns: [0, 1, 2, 3, 4, 5, 6]
                  }
              }
          ],
          "order": [
              [2, "asc"]
          ]

      });
  });
</script>
<script type="text/javascript">
  $(document).ready(function() {
      $("input[type=search]").focus();
  });
  $(document).ready(function() {
      $("input[type=search]").each(function(ev) {
          if (!$(this).val()) {
              $(this).attr("placeholder", "Search");
          }
      });
  });
$('#supplier').prepend('<option></option>').select2({ placeholder: " Please Select" });
</script>